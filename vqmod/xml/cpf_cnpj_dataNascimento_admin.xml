
<modification>
	<id>administrativo módulo de CPF CNPJ Razão Social Inscrição Estadual e Data de nascimento</id>
	<version>1.0.1</version>
	<vqmver>2.1.5</vqmver>
	<author>Jeann e-mail: jeann@surgimento.com.br twiter: @surgimento site: http://www.surgimento.com.br/ </author>
	
	<!-- BLOCO RESPONSAVEL POR MOSTRAR OS DADOS NO DETALHE DO PEDIDO -->
	<file name="admin/controller/sale/order.php">
		<operation> <!-- linha 1545 geral - Carrega as variaveis dos novos campos na função info() para carregar assim que clica em visualizar pedido na pagina sale/order/info -->
			<search position="before"><![CDATA[
			if ($order_info['customer_id']) {
			]]></search>
			<add><![CDATA[
				
					$this->data['cpf'] = $order_info['cpf'];
					$this->data['cnpj'] = $order_info['cnpj'];
					$this->data['razao_social'] = $order_info['razao_social'];
					$this->data['inscricao_estadual'] = $order_info['inscricao_estadual'];
					$this->data['data_nascimento'] = $order_info['data_nascimento'];
					$this->data['ddd'] = $order_info['ddd'];
					
					
					
					$this->data['ddd2'] = $order_info['ddd2'];
					$this->data['telephone2'] = $order_info['telephone2'];
					$this->data['sexo'] = $order_info['sexo'];
					// $this->data['placa1'] = $order_info['placa1'];
					// $this->data['placa2'] = $order_info['placa2'];
					
					$this->data['shipping_numero'] = $order_info['shipping_numero'];
					$this->data['shipping_complemento'] = $order_info['shipping_complemento'];
					$this->data['payment_numero'] = $order_info['payment_numero'];
					$this->data['payment_complemento'] = $order_info['payment_complemento'];
				
			]]></add>
		</operation>
		
		<operation> <!-- linha 2403 e 2437 geral -  adiciona numero e complemento na fatura função invoice() -->
			<search position="replace"><![CDATA[
			$format = '{firstname} {lastname}' . "\n" . '{company}' . "\n" . '{address_1}' . "\n" . '{address_2}' . "\n" . '{city} {postcode}' . "\n" . '{zone}' . "\n" . '{country}';
			]]></search>
			<add><![CDATA[
				$format = '{firstname} {lastname}' . "\n" . '{company}' . "\n" . '{address_1} {numero} {complemento}' . "\n" . '{address_2}' . "\n" . '{city} {postcode}' . "\n" . '{zone}' . "\n" . '{country}';
			]]></add>
		</operation>
		
		<operation> <!-- linha 2410 e 2444 geral -  adiciona numero e complemento na fatura função invoice()-->
			<search position="after"><![CDATA[
			'{address_1}',
			]]></search>
			<add><![CDATA[
				'{numero}',
				'{complemento}',
			]]></add>
		</operation>
		
		<operation>  <!-- Linha 2423 geral - adiciona numero e complemento na fatura função invoice()-->
			<search position="after" ><![CDATA[
			'address_1' => $order_info['shipping_address_1'],
			]]></search>
			<add><![CDATA[
			'numero' => $order_info['shipping_numero'],	
			'complemento' => $order_info['shipping_complemento'],
			]]></add>
		</operation>
		
		<operation>  <!-- Linha 2457 geral - adiciona numero e complemento na fatura função invoice() -->
			<search position="after" ><![CDATA[
			'address_1' => $order_info['payment_address_1'],
			]]></search>
			<add><![CDATA[
			'numero' => $order_info['payment_numero'],	
			'complemento' => $order_info['payment_complemento'],
			]]></add>
		</operation>	
		
		<operation> <!-- linha 2525 geral -  adiciona DDD e CPF, CNPJ, Razão Social e inscrição estadual função invoice() -->
			<search position="after"><![CDATA[
			'email'              => $order_info['email'],
			]]></search>
			<add><![CDATA[
				'ddd'          => $order_info['ddd'],
				'cpf'          => $order_info['cpf'], 
				'cnpj'          => $order_info['cnpj'],
				'razao_social'          => $order_info['razao_social'],
				'inscricao_estadual'          => $order_info['inscricao_estadual'],
				'ddd2'  => $order_info['ddd2'],
				'telephone2' => $order_info['telephone2'],
				'sexo' => $order_info['sexo'],
				// 'placa1' => $order_info['placa1'],
				// 'placa2' => $order_info['placa2'],
				
			]]></add>
		</operation>
		<!-- INICIO, DAQUI PARA BAIXO É SÓ PARA VERSÕES 1.5.4.1 ####################################################### -->
		<!-- ################################################################################################## -->
		<!-- ################################################################################################## -->
		
		

		
		<operation> <!-- linha 673 geral dentro da função getForm() coloca validação nos campos novos -->
			<search position="after" offset="1"><![CDATA[
			$this->data['error_lastname'] = '';
			]]></search>
			<add><![CDATA[
			if ($this->config->get('dados_status')){
				if (isset($this->error['data_nascimento'])) {
					$this->data['error_data_nascimento'] = $this->error['data_nascimento'];
				} else {
					$this->data['error_data_nascimento'] = '';
				}
						
				if (isset($this->error['cpf'])) {
					$this->data['error_cpf'] = $this->error['cpf'];
				} else {
					$this->data['error_cpf'] = '';
				}
						
				if (isset($this->error['cnpj'])) {
					$this->data['error_cnpj'] = $this->error['cnpj'];
				} else {
					$this->data['error_cnpj'] = '';
				}
				
				if (isset($this->error['address_numero'])) {
					$this->data['error_address_numero'] = $this->error['address_numero'];
				} else {
					$this->data['error_address_numero'] = '';
				}
				
				if (isset($this->error['ddd'])) {
					$this->data['error_ddd'] = $this->error['ddd'];
				} else {
					$this->data['error_ddd'] = '';
				}		
			}
			]]></add>
		</operation>
		
		<operation> <!-- linha 1180 geral dentro da função validateForm() adiciona validação para os campos novos -->
			<search position="after" offset="1"><![CDATA[
			$this->error['email'] = $this->language->get('error_email');
			]]></search>
			<add><![CDATA[
			
			
				/*
                $dataparts = explode("/",$this->request->post['data_nascimento']);
                // se o campo de data for preenchido ai será validado
                if (strlen(utf8_decode($this->request->post['data_nascimento'])) > 0) {
                    // se a array não tiver 3 posições nem checa a data
                    if (sizeof($dataparts)<>"3"){
                        $this->error['data_nascimento'] = "Essa data não é válida";
                    }else{
                        //checa se o que foi digitado a data
                        if (!checkdate($dataparts[1],$dataparts[0],$dataparts[2])) {
                                $this->error['data_nascimento'] = "Essa data não é válida";
                        }
                    } 
                }elseif (strlen(utf8_decode($this->request->post['data_nascimento'])) < 1) {
					if ($this->config->get('dados_nascimento')){
						$this->error['data_nascimento'] = "O campo Data de Nascimento é obrigatório";  
					}
				}
                if ($this->request->post['pessoa'] == "fisica"){
                    if ($this->config->get('dados_cpf')){
						if ((strlen(utf8_decode($this->request->post['cpf'])) < 1) || (strlen(utf8_decode($this->request->post['cpf'])) > 14)) {
								$this->error['cpf'] = "O CPF é obrigatório";  
						}elseif (!$this->cpf($this->request->post['cpf'])){
							$this->error['cpf'] = "O CPF é inválido!";  
						}
					}
                }else if ($this->request->post['pessoa'] == "juridica"){
                    if ($this->config->get('dados_cnpj')){
						 if ((strlen(utf8_decode($this->request->post['cnpj'])) < 1) || (strlen(utf8_decode($this->request->post['cnpj'])) > 18)&&($this->request->post['pessoa'] == "juridica")) {
						$this->error['cnpj'] = "O CNPJ é obrigatório";
						} elseif (!$this->cnpj($this->request->post['cnpj'])){
							$this->error['cnpj'] = "O CNPJ é inválido!";  
						} 
					}	
                }
				*/	
				if ((strlen(utf8_decode($this->request->post['ddd'])) < 1)) {
                        $this->error['ddd'] = "O campo ddd é obrigatório";
				}
				
			
				
			]]></add>
		</operation>
		
		<operation> <!-- linha 943 geral -  tira validação de sobrenome função validateForm() -->
			<search position="before" ><![CDATA[
				if (isset($this->request->post['payment_address_2'])) {
			]]></search>
			<add><![CDATA[	

			if (isset($this->request->post['data_nascimento'])) {
				$this->data['data_nascimento'] = $this->request->post['data_nascimento'];
			} elseif (!empty($order_info)) { 
				$this->data['data_nascimento'] = $order_info['data_nascimento'];
			} else {
				$this->data['data_nascimento'] = '';
			}
			if (isset($this->request->post['pessoa'])) {
				$this->data['pessoa'] = $this->request->post['pessoa'];
			} else {
				$this->data['pessoa'] = '';
			}
			if (isset($this->request->post['cpf'])) {
				$this->data['cpf'] = $this->request->post['cpf'];
			} elseif (!empty($order_info)) { 
				$this->data['cpf'] = $order_info['cpf'];
			} else {
				$this->data['cpf'] = '';
			}
			
			if (isset($this->request->post['cnpj'])) {
				$this->data['cnpj'] = $this->request->post['cnpj'];
			} elseif (!empty($order_info)) { 
				$this->data['cnpj'] = $order_info['cnpj'];
			} else {
				$this->data['cnpj'] = '';
			}
			
			if (isset($this->request->post['razao_social'])) {
				$this->data['razao_social'] = $this->request->post['razao_social'];
			} elseif (!empty($order_info)) { 
				$this->data['razao_social'] = $order_info['razao_social'];
			} else {
				$this->data['razao_social'] = '';
			}

			if (isset($this->request->post['inscricao_estadual'])) {
				$this->data['inscricao_estadual'] = $this->request->post['inscricao_estadual'];
			} elseif (!empty($order_info)) { 
				$this->data['inscricao_estadual'] = $order_info['inscricao_estadual'];
			} else {
				$this->data['inscricao_estadual'] = '';
			}
		
			if (isset($this->request->post['ddd'])) {
				$this->data['ddd'] = $this->request->post['ddd'];
			} elseif (!empty($order_info)) { 
				$this->data['ddd'] = $order_info['ddd'];
			} else {
				$this->data['ddd'] = '';
			}
			
			if (isset($this->request->post['ddd2'])) {
				$this->data['ddd2'] = $this->request->post['ddd2'];
			} elseif (!empty($order_info)) { 
				$this->data['ddd2'] = $order_info['ddd2'];
			} else {
				$this->data['ddd2'] = '';
			}
			if (isset($this->request->post['telephone2'])) {
				$this->data['telephone2'] = $this->request->post['telephone2'];
			} elseif (!empty($order_info)) { 
				$this->data['telephone2'] = $order_info['telephone2']; 
			} else {
				$this->data['telephone2'] = '';
			}
			
			if (isset($this->request->post['sexo'])) {
				$this->data['sexo'] = $this->request->post['sexo'];
			} elseif (!empty($order_info)) { 
				$this->data['sexo'] = $order_info['sexo']; 
			} else {
				$this->data['sexo'] = '';
			}
			/*
			if (isset($this->request->post['placa1'])) {
				$this->data['placa1'] = $this->request->post['placa1'];
			} elseif (!empty($order_info)) { 
				$this->data['placa1'] = $order_info['placa1'];
			} else {
				$this->data['placa1'] = '';
			}
			if (isset($this->request->post['placa2'])) {
				$this->data['placa2'] = $this->request->post['placa2'];
			} elseif (!empty($order_info)) { 
				$this->data['placa2'] = $order_info['placa2'];
			} else {
				$this->data['placa2'] = '';
			}
			*/
			
			
			if (isset($this->request->post['payment_numero'])) {
				$this->data['payment_numero'] = $this->request->post['payment_numero'];
			} elseif (!empty($order_info)) { 
				$this->data['payment_numero'] = $order_info['payment_numero'];
			} else {
				$this->data['payment_numero'] = '';
			}
		
			if (isset($this->request->post['payment_complemento'])) {
				$this->data['payment_complemento'] = $this->request->post['payment_complemento'];
			} elseif (!empty($order_info)) { 
				$this->data['payment_complemento'] = $order_info['payment_complemento'];
			} else {
				$this->data['payment_complemento'] = '';
			}
			
			if (isset($this->request->post['shipping_numero'])) {
				$this->data['shipping_numero'] = $this->request->post['shipping_numero'];
			} elseif (!empty($order_info)) { 
				$this->data['shipping_numero'] = $order_info['shipping_numero'];
			} else {
				$this->data['shipping_numero'] = '';
			}
		
			if (isset($this->request->post['shipping_complemento'])) {
				$this->data['shipping_complemento'] = $this->request->post['shipping_complemento'];
			} elseif (!empty($order_info)) { 
				$this->data['shipping_complemento'] = $order_info['shipping_complemento'];
			} else {
				$this->data['shipping_complemento'] = '';
			}
			
			]]></add>
		</operation>
		
		<!-- FIM, DAQUI PARA BAIXO É SÓ PARA VERSÕES 1.5.4.1 ####################################################### -->
		<!-- ################################################################################################## -->
		<!-- ################################################################################################## -->
	</file>
	<file name="admin/view/template/sale/order_invoice.tpl">
		<operation> <!-- linha 59 geral - adiciona DDD e CPF, CNPJ, Razão Social e inscrição estadual -->
			<search position="replace"><![CDATA[
			<?php echo $order['telephone']; ?>
			]]></search>
			<add><![CDATA[
				Tel: <?php echo $order['ddd']; ?> <?php echo $order['telephone']; ?><br/>
				Celular: <?php echo $order['ddd2']; ?> <?php echo $order['telephone2']; ?><br/>
				<?php if ($order['cpf']<>"") { ?>
					CPF: <?php echo $order['cpf']; ?><br/>
					Sexo: <?php if ($order['sexo']=="m"){echo "Masculino";}else{echo "Feminino";} ?><br/>
					<?php /* Renavam: <?php echo $order['placa1']; ?>	<br/> */ ?>
				<?php }else{ ?>
					CNPJ: <?php echo $order['cnpj']; ?><br/>
					Razão Social: <?php echo $order['razao_social']; ?><br/>
					Inscrição Estadual: <?php echo $order['inscricao_estadual']; ?><br/>
					Sexo: <?php if ($order['sexo']=="m"){echo "Masculino";}else{echo "Feminino";} ?><br/>
					<?php /*
					// Renavam: <?php echo $order['placa1']; ?><br/>
					// Renavam 2: <?php echo $order['placa2']; ?><br/>
					*/ ?>
				<?php } ?>
			
			]]></add>
		</operation>
	</file>
	<file name="admin/model/sale/order.php">	
		<operation> <!-- linha 357 geral - Carrega os campos novos campos direto do banco de dados na função getOrder($order_id) do model -->
			<search position="replace" offset="3"><![CDATA[
			$language_directory = '';
			]]></search>
			<add><![CDATA[
			$language_directory = '';
			}
				
				$customer_query = $this->db->query("SELECT cpf,cnpj,razao_social,inscricao_estadual,ddd, data_nascimento, ddd2, telephone2, sexo, placa1, placa2 FROM " . DB_PREFIX . "customer WHERE customer_id = '" . $order_query->row['customer_id'] . "'");     
				if ($customer_query->num_rows) {
					$cpf = $customer_query->row['cpf'];
					$cnpj = $customer_query->row['cnpj'];
					$razao_social = $customer_query->row['razao_social'];
					$inscricao_estadual = $customer_query->row['inscricao_estadual'];
					$data_nascimento = $customer_query->row['data_nascimento'];
					
					$ddd = $order_query->row['ddd'];
					
					$ddd2 = $customer_query->row['ddd2'];
					$telephone2 = $customer_query->row['telephone2'];
					$sexo = $customer_query->row['sexo'];
					// $placa1 = $customer_query->row['placa1'];
					// $placa2 = $customer_query->row['placa2'];
				} else {
					$cpf = "";
					$cnpj = "";
					$razao_social = "";
					$inscricao_estadual = "";
					$data_nascimento = "";		
					$ddd = "";
					$ddd2 = "";
					$telephone2 = "";
					$sexo = "";
					// $placa1 = "";
					// $placa2 = "";

				}
				return array(
						'cpf'               => $cpf,
						'cnpj'               => $cnpj,
						'razao_social'               => $razao_social,
						'inscricao_estadual'               => $inscricao_estadual,
						'data_nascimento'               => $data_nascimento,	
						'ddd'               => $ddd,
						'ddd2'               => $ddd2,	
						'telephone2'         => $telephone2,	
						'sexo'               => $sexo,	
						// 'placa1'               => $placa1,
						// 'placa2'               => $placa2,	
						'shipping_numero'  => $order_query->row['shipping_numero'],
						'shipping_complemento' => $order_query->row['shipping_complemento'],
						'payment_numero'  => $order_query->row['payment_numero'],
						'payment_complemento' => $order_query->row['payment_complemento'],
			]]></add>
		</operation>
		
		<!-- INICIO, DAQUI PARA BAIXO É SÓ PARA VERSÕES 1.5.4.1 ####################################################### -->
		<!-- ################################################################################################## -->
		<!-- ################################################################################################## -->
		
		<operation> <!-- linha 80 geral - grava novos campos direto do banco de dados na função addOrder do model -->
			<search position="replace" ><![CDATA[
		$this->db->query("INSERT INTO `" . DB_PREFIX . "order` SET invoice_prefix = '" . $this->db->escape($invoice_prefix) . "', store_id = '" . (int)$data['store_id'] . "', store_name = '" . $this->db->escape($store_name) . "',store_url = '" . $this->db->escape($store_url) . "', customer_id = '" . (int)$data['customer_id'] . "', customer_group_id = '" . (int)$data['customer_group_id'] . "', firstname = '" . $this->db->escape($data['firstname']) . "', lastname = '" . $this->db->escape($data['lastname']) . "', email = '" . $this->db->escape($data['email']) . "', telephone = '" . $this->db->escape($data['telephone']) . "', fax = '" . $this->db->escape($data['fax']) . "', payment_firstname = '" . $this->db->escape($data['payment_firstname']) . "', payment_lastname = '" . $this->db->escape($data['payment_lastname']) . "', payment_company = '" . $this->db->escape($data['payment_company']) . "', payment_company_id = '" . $this->db->escape($data['payment_company_id']) . "', payment_tax_id = '" . $this->db->escape($data['payment_tax_id']) . "', payment_address_1 = '" . $this->db->escape($data['payment_address_1']) . "', payment_address_2 = '" . $this->db->escape($data['payment_address_2']) . "', payment_city = '" . $this->db->escape($data['payment_city']) . "', payment_postcode = '" . $this->db->escape($data['payment_postcode']) . "', payment_country = '" . $this->db->escape($payment_country) . "', payment_country_id = '" . (int)$data['payment_country_id'] . "', payment_zone = '" . $this->db->escape($payment_zone) . "', payment_zone_id = '" . (int)$data['payment_zone_id'] . "', payment_address_format = '" . $this->db->escape($payment_address_format) . "', payment_method = '" . $this->db->escape($data['payment_method']) . "', payment_code = '" . $this->db->escape($data['payment_code']) . "', shipping_firstname = '" . $this->db->escape($data['shipping_firstname']) . "', shipping_lastname = '" . $this->db->escape($data['shipping_lastname']) . "', shipping_company = '" . $this->db->escape($data['shipping_company']) . "', shipping_address_1 = '" . $this->db->escape($data['shipping_address_1']) . "', shipping_address_2 = '" . $this->db->escape($data['shipping_address_2']) . "', shipping_city = '" . $this->db->escape($data['shipping_city']) . "', shipping_postcode = '" . $this->db->escape($data['shipping_postcode']) . "', shipping_country = '" . $this->db->escape($shipping_country) . "', shipping_country_id = '" . (int)$data['shipping_country_id'] . "', shipping_zone = '" . $this->db->escape($shipping_zone) . "', shipping_zone_id = '" . (int)$data['shipping_zone_id'] . "', shipping_address_format = '" . $this->db->escape($shipping_address_format) . "', shipping_method = '" . $this->db->escape($data['shipping_method']) . "', shipping_code = '" . $this->db->escape($data['shipping_code']) . "', comment = '" . $this->db->escape($data['comment']) . "', order_status_id = '" . (int)$data['order_status_id'] . "', affiliate_id  = '" . (int)$data['affiliate_id'] . "', language_id = '" . (int)$this->config->get('config_language_id') . "', currency_id = '" . (int)$currency_id . "', currency_code = '" . $this->db->escape($currency_code) . "', currency_value = '" . (float)$currency_value . "', date_added = NOW(), date_modified = NOW()");
					]]></search>
			<add><![CDATA[
		
			if ($data['data_nascimento'] == ""){
				$dataparts[0] = "00";
				$dataparts[1] = "00";
				$dataparts[2] = "0000";
			}else{
				$dataparts = explode("/",$data['data_nascimento']);
			} 
		
		$this->db->query("INSERT INTO `" . DB_PREFIX . "order` SET invoice_prefix = '" . $this->db->escape($invoice_prefix) . "', store_id = '" . (int)$data['store_id'] . "', store_name = '" . $this->db->escape($store_name) . "',store_url = '" . $this->db->escape($store_url) . "', customer_id = '" . (int)$data['customer_id'] . "', customer_group_id = '" . (int)$data['customer_group_id'] . "', firstname = '" . $this->db->escape($data['firstname']) . "', lastname = '" . $this->db->escape($data['lastname']) . "', email = '" . $this->db->escape($data['email']) . "', telephone = '" . $this->db->escape($data['telephone']) . "',ddd = '" . $this->db->escape($data['ddd']) . "', fax = '" . $this->db->escape($data['fax']) . "', payment_firstname = '" . $this->db->escape($data['payment_firstname']) . "', payment_lastname = '" . $this->db->escape($data['payment_lastname']) . "', payment_company = '', payment_company_id = '', payment_tax_id = '', payment_address_1 = '" . $this->db->escape($data['payment_address_1']) . "', payment_numero = '" . $this->db->escape($data['payment_numero']) . "', payment_complemento = '" . $this->db->escape($data['payment_complemento']) . "', payment_address_2 = '" . $this->db->escape($data['payment_address_2']) . "', payment_city = '" . $this->db->escape($data['payment_city']) . "', payment_postcode = '" . $this->db->escape($data['payment_postcode']) . "', payment_country = '" . $this->db->escape($payment_country) . "', payment_country_id = '" . (int)$data['payment_country_id'] . "', payment_zone = '" . $this->db->escape($payment_zone) . "', payment_zone_id = '" . (int)$data['payment_zone_id'] . "', payment_address_format = '" . $this->db->escape($payment_address_format) . "', payment_method = '" . $this->db->escape($data['payment_method']) . "', payment_code = '" . $this->db->escape($data['payment_code']) . "', shipping_firstname = '" . $this->db->escape($data['shipping_firstname']) . "', shipping_lastname = '" . $this->db->escape($data['shipping_lastname']) . "', shipping_company = '', shipping_address_1 = '" . $this->db->escape($data['shipping_address_1']) . "', shipping_numero = '" . $this->db->escape($data['shipping_numero']) . "', shipping_complemento = '" . $this->db->escape($data['shipping_complemento']) . "', shipping_address_2 = '" . $this->db->escape($data['shipping_address_2']) . "', shipping_city = '" . $this->db->escape($data['shipping_city']) . "', shipping_postcode = '" . $this->db->escape($data['shipping_postcode']) . "', shipping_country = '" . $this->db->escape($shipping_country) . "', shipping_country_id = '" . (int)$data['shipping_country_id'] . "', shipping_zone = '" . $this->db->escape($shipping_zone) . "', shipping_zone_id = '" . (int)$data['shipping_zone_id'] . "', shipping_address_format = '" . $this->db->escape($shipping_address_format) . "', shipping_method = '" . $this->db->escape($data['shipping_method']) . "', shipping_code = '" . $this->db->escape($data['shipping_code']) . "', comment = '" . $this->db->escape($data['comment']) . "', order_status_id = '" . (int)$data['order_status_id'] . "', affiliate_id  = '" . (int)$data['affiliate_id'] . "', language_id = '" . (int)$this->config->get('config_language_id') . "', currency_id = '" . (int)$currency_id . "', currency_code = '" . $this->db->escape($currency_code) . "', currency_value = '" . (float)$currency_value . "', date_added = NOW(), date_modified = NOW()");
		
			]]></add>
		</operation>

		
		<operation> <!-- linha 183 geral - grava novos campos direto do banco de dados na função editOrder do model -->
			<search position="replace" ><![CDATA[
			$this->db->query("UPDATE `" . DB_PREFIX . "order` SET firstname = '" . $this->db->escape($data['firstname']) . "', lastname = '" . $this->db->escape($data['lastname']) . "', email = '" . $this->db->escape($data['email']) . "', telephone = '" . $this->db->escape($data['telephone']) . "', fax = '" . $this->db->escape($data['fax']) . "', payment_firstname = '" . $this->db->escape($data['payment_firstname']) . "', payment_lastname = '" . $this->db->escape($data['payment_lastname']) . "', payment_company = '" . $this->db->escape($data['payment_company']) . "', payment_company_id = '" . $this->db->escape($data['payment_company_id']) . "', payment_tax_id = '" . $this->db->escape($data['payment_tax_id']) . "', payment_address_1 = '" . $this->db->escape($data['payment_address_1']) . "', payment_address_2 = '" . $this->db->escape($data['payment_address_2']) . "', payment_city = '" . $this->db->escape($data['payment_city']) . "', payment_postcode = '" . $this->db->escape($data['payment_postcode']) . "', payment_country = '" . $this->db->escape($payment_country) . "', payment_country_id = '" . (int)$data['payment_country_id'] . "', payment_zone = '" . $this->db->escape($payment_zone) . "', payment_zone_id = '" . (int)$data['payment_zone_id'] . "', payment_address_format = '" . $this->db->escape($payment_address_format) . "', payment_method = '" . $this->db->escape($data['payment_method']) . "', payment_code = '" . $this->db->escape($data['payment_code']) . "', shipping_firstname = '" . $this->db->escape($data['shipping_firstname']) . "', shipping_lastname = '" . $this->db->escape($data['shipping_lastname']) . "',  shipping_company = '" . $this->db->escape($data['shipping_company']) . "', shipping_address_1 = '" . $this->db->escape($data['shipping_address_1']) . "', shipping_address_2 = '" . $this->db->escape($data['shipping_address_2']) . "', shipping_city = '" . $this->db->escape($data['shipping_city']) . "', shipping_postcode = '" . $this->db->escape($data['shipping_postcode']) . "', shipping_country = '" . $this->db->escape($shipping_country) . "', shipping_country_id = '" . (int)$data['shipping_country_id'] . "', shipping_zone = '" . $this->db->escape($shipping_zone) . "', shipping_zone_id = '" . (int)$data['shipping_zone_id'] . "', shipping_address_format = '" . $this->db->escape($shipping_address_format) . "', shipping_method = '" . $this->db->escape($data['shipping_method']) . "', shipping_code = '" . $this->db->escape($data['shipping_code']) . "', comment = '" . $this->db->escape($data['comment']) . "', order_status_id = '" . (int)$data['order_status_id'] . "', affiliate_id  = '" . (int)$data['affiliate_id'] . "', date_modified = NOW() WHERE order_id = '" . (int)$order_id . "'");
			]]></search>
			<add><![CDATA[
			if ($data['data_nascimento'] == ""){
				$dataparts[0] = "00";
				$dataparts[1] = "00";
				$dataparts[2] = "0000";
			}else{
				$dataparts = explode("/",$data['data_nascimento']);
			}  
			
			
			/* adiciona apagar	
			$this->db->query("UPDATE " . DB_PREFIX . "customer SET firstname = '" . $this->db->escape($data['firstname']) . "', lastname = '', email = '" . $this->db->escape($data['email']) . "', telephone = '" . $this->db->escape($data['telephone']) . "',cpf = '" . $this->db->escape($data['cpf']) . "',cnpj = '" . $this->db->escape($data['cnpj']) . "',razao_social = '" . $this->db->escape($data['razao_social']) . "',inscricao_estadual = '" . $this->db->escape($data['inscricao_estadual']) . "',ddd = '" . $this->db->escape($data['ddd']) . "', data_nascimento = '" . $this->db->escape($dataparts[2]."-".$dataparts[1]."-".$dataparts[0]) . "', fax = '" . $this->db->escape($data['fax']) . "', newsletter = '" . (int)$data['newsletter'] . "', customer_group_id = '" . (int)$data['customer_group_id'] . "', status = '" . (int)$data['status'] . "' WHERE customer_id = '" . (int)$customer_id . "'"); */
			
			$this->db->query("UPDATE `" . DB_PREFIX . "order` SET firstname = '" . $this->db->escape($data['firstname']) . "', lastname = '', email = '" . $this->db->escape($data['email']) . "', telephone = '" . $this->db->escape($data['telephone']) . "',ddd = '" . $this->db->escape($data['ddd']) . "', fax = '', payment_firstname = '" . $this->db->escape($data['payment_firstname']) . "', payment_lastname = '". $this->db->escape($data['payment_lastname']) ."', payment_company = '', payment_company_id = '', payment_tax_id = '', payment_address_1 = '" . $this->db->escape($data['payment_address_1']) . "', payment_numero = '" . $this->db->escape($data['payment_numero']) . "', payment_complemento = '" . $this->db->escape($data['payment_complemento']) . "', payment_address_2 = '" . $this->db->escape($data['payment_address_2']) . "', payment_city = '" . $this->db->escape($data['payment_city']) . "', payment_postcode = '" . $this->db->escape($data['payment_postcode']) . "', payment_country = '" . $this->db->escape($payment_country) . "', payment_country_id = '" . (int)$data['payment_country_id'] . "', payment_zone = '" . $this->db->escape($payment_zone) . "', payment_zone_id = '" . (int)$data['payment_zone_id'] . "', payment_address_format = '" . $this->db->escape($payment_address_format) . "', payment_method = '" . $this->db->escape($data['payment_method']) . "', payment_code = '" . $this->db->escape($data['payment_code']) . "', shipping_firstname = '" . $this->db->escape($data['shipping_firstname']) . "', shipping_lastname = '" . $this->db->escape($data['shipping_lastname']) . "',  shipping_company = '', shipping_address_1 = '" . $this->db->escape($data['shipping_address_1']) . "', shipping_numero = '" . $this->db->escape($data['shipping_numero']) . "', shipping_complemento = '" . $this->db->escape($data['shipping_complemento']) . "', shipping_address_2 = '" . $this->db->escape($data['shipping_address_2']) . "', shipping_city = '" . $this->db->escape($data['shipping_city']) . "', shipping_postcode = '" . $this->db->escape($data['shipping_postcode']) . "', shipping_country = '" . $this->db->escape($shipping_country) . "', shipping_country_id = '" . (int)$data['shipping_country_id'] . "', shipping_zone = '" . $this->db->escape($shipping_zone) . "', shipping_zone_id = '" . (int)$data['shipping_zone_id'] . "', shipping_address_format = '" . $this->db->escape($shipping_address_format) . "', shipping_method = '" . $this->db->escape($data['shipping_method']) . "', shipping_code = '" . $this->db->escape($data['shipping_code']) . "', comment = '" . $this->db->escape($data['comment']) . "', order_status_id = '" . (int)$data['order_status_id'] . "', affiliate_id  = '" . (int)$data['affiliate_id'] . "', date_modified = NOW() WHERE order_id = '" . (int)$order_id . "'");
			]]></add>
		</operation>
		<!-- FIM, DAQUI PARA BAIXO É SÓ PARA VERSÕES 1.5.4.1 ####################################################### -->
		<!-- ################################################################################################## -->
		<!-- ################################################################################################## -->
	</file>
	<file name="admin/view/template/sale/order_info.tpl">
		<operation>	<!-- linha 68 geral - coloca campo novo de DDD e os novos logo na parte geral do pedido --> 	 
			<search position="replace" offset="1"><![CDATA[
			<td><?php echo $telephone; ?></td>
			]]></search>
			<add><![CDATA[
			<td><?php if ($ddd<>""){echo $ddd;} ?> <?php echo $telephone; ?></td>
			</tr>
					<tr>
						<td>Celular:</td>
						<td><?php echo $ddd2; ?> <?php echo $telephone2; ?></td>
				    </tr>
			
					<tr>
						<td>Sexo:</td>
						<td><?php if ($sexo=="m"){echo "Masculino";}else{echo "Feminino";} ?></td>
				    </tr>
					<?php if ($cpf<>""){?>
					  <tr>
						<td>CPF:</td>
						<td><?php echo $cpf; ?></td>
					  </tr>
					   <?php
					  /*
					  <tr>
						<td>Renavam: </td>
						<td><?php echo $placa1; ?></td> 
					  </tr>
					  */ ?>
				  <?php }else if ($cnpj<>"") {?>
					  <tr>
						<td>CNPJ:</td>
						<td><?php echo $cnpj; ?></td>
					  </tr>
					  <tr>
						<td>Razao Social:</td>
						<td><?php echo $razao_social; ?></td>
					  </tr>
					  <tr>
						<td>Inscrição Estadual:</td>
						<td><?php echo $inscricao_estadual; ?></td>
					  </tr>
					  
					  <?php
					  /*
					  <tr>
						<td>Renavam: </td>
						<td><?php echo $placa1; ?></td>
					  </tr>
					  <tr>
						<td>Renavam 2:</td>
						<td><?php echo $placa2; ?></td>
					  </tr>
					  */ ?>
				  <?php } ?>
				  <?php if ($data_nascimento<>"") {?>
				  <tr>
					<td>Data Nascimento</td>
					<?php 
					  $dataparts = explode("-",$data_nascimento);
					  if (sizeof($dataparts)<>"3"){
						  $data = $data_nascimento;
					  }else{
						  $data = $dataparts[2]."/".$dataparts[1]."/".$dataparts[0]; 
					  }
					?>
					<td><?php echo $data; ?></td>
				  </tr>
				  <?php }?>
			  
			]]></add>
		</operation> 
	
	
		<operation> <!-- linha 189 geral - coloca campo novo de numero e complemento --> 
			<search position="after" offset="1"><![CDATA[ 
			<td><?php echo $payment_address_1; ?></td>
			]]></search>
			<add><![CDATA[
			<?php if ($this->config->get('dados_status')){ ?>
			<tr>
				<td>Numero:</td>
				<td><?php echo $payment_numero; ?></td>
			</tr>
			<tr>
				<td>Complemento:</td>
				<td><?php echo $payment_complemento; ?></td>
			</tr>
			<?php }?>
			]]></add>
		</operation>
	
		<operation> <!-- linha 246 geral - coloca campo novo de numero e complemento --> 
			<search position="after" offset="1"><![CDATA[ 
			<td><?php echo $shipping_address_1; ?></td>
			]]></search>
			<add><![CDATA[
			<?php if ($this->config->get('dados_status')){ ?>
			<tr>
				<td>Numero:</td>
				<td><?php echo $shipping_numero; ?></td>
			</tr>
			<tr>
				<td>Complemento:</td>
				<td><?php echo $shipping_complemento; ?></td>
			</tr>
			<?php }?>
			]]></add>
		</operation>
		<operation> <!-- linha 193 e 250 geral - muda a tradução para bairro em 2 pontos --> 
			<search position="replace" ><![CDATA[ 
			<td><?php echo $text_address_2; ?></td>
			]]></search>
			<add><![CDATA[
			<td>Bairro: </td>  
			]]></add>
		</operation>	
	</file>
	
	
	<!-- BLOCO RESPONSAVEL POR CADASTRO DE CLIENTES PELO ADMINISTRATIVO -->
	<file name="admin/model/sale/customer.php">
		<operation> <!-- linha 3 geral dentro da função addCustomer() adiciona juntos cpf, cnpj, razao_social, inscricao_estadual, ddd, data_nascimento -->
			<search position="replace"><![CDATA[
			$this->db->query("INSERT INTO " . DB_PREFIX . "customer SET firstname = '" . $this->db->escape($data['firstname']) . "', lastname = '" . $this->db->escape($data['lastname']) . "', email = '" . $this->db->escape($data['email']) . "', telephone = '" . $this->db->escape($data['telephone']) . "', fax = '" . $this->db->escape($data['fax']) . "', newsletter = '" . (int)$data['newsletter'] . "', customer_group_id = '" . (int)$data['customer_group_id'] . "', salt = '" . $this->db->escape($salt = substr(md5(uniqid(rand(), true)), 0, 9)) . "', password = '" . $this->db->escape(sha1($salt . sha1($salt . sha1($data['password'])))) . "', status = '" . (int)$data['status'] . "', date_added = NOW()");
			]]></search>
			<add><![CDATA[
			
				if ($data['data_nascimento'] == ""){
					$dataparts[0] = "00";
					$dataparts[1] = "00";
					$dataparts[2] = "0000";
				}else{
					$dataparts = explode("/",$data['data_nascimento']);
				}  
				// adiciona juntos cpf, cnpj, razao_social, inscricao_estadual, ddd, data_nascimento	
				$this->db->query("INSERT INTO " . DB_PREFIX . "customer SET firstname = '" . $this->db->escape($data['firstname']) . "', lastname = '" . $this->db->escape($data['lastname']) . "', email = '" . $this->db->escape($data['email']) . "', telephone = '" . $this->db->escape($data['telephone']) . "',cpf = '" . $this->db->escape($data['cpf']) . "',cnpj = '" . $this->db->escape($data['cnpj']) . "',razao_social = '" . $this->db->escape($data['razao_social']) . "',inscricao_estadual = '" . $this->db->escape($data['inscricao_estadual']) . "',ddd = '" . $this->db->escape($data['ddd']) . "', data_nascimento = '" . $this->db->escape($dataparts[2]."-".$dataparts[1]."-".$dataparts[0]) . "',ddd2 = '" . $this->db->escape($data['ddd2']) . "', telephone2 = '" . $this->db->escape($data['telephone2']) . "',  sexo = '" . $this->db->escape($data['sexo']) . "', placa1 = '',placa2 = '', fax = '" . $this->db->escape($data['fax']) . "', newsletter = '" . (int)$data['newsletter'] . "', customer_group_id = '" . (int)$data['customer_group_id'] . "', salt = '" . $this->db->escape($salt = substr(md5(uniqid(rand(), true)), 0, 9)) . "', password = '" . $this->db->escape(sha1($salt . sha1($salt . sha1($data['password'])))) . "', status = '" . (int)$data['status'] . "', date_added = NOW()");
				
			
			]]></add>
		</operation>	
		<operation> <!-- linha 10 geral dentro da função addCustomer() Adiciona juntos o campo numero e complemento -->
			<search position="replace" ><![CDATA[
			$this->db->query("INSERT INTO " . DB_PREFIX . "address SET customer_id = '" . (int)$customer_id . "', firstname = '" . $this->db->escape($address['firstname']) . "', lastname = '" . $this->db->escape($address['lastname']) . "', company = '" . $this->db->escape($address['company']) . "', company_id = '" . $this->db->escape($address['company_id']) . "', tax_id = '" . $this->db->escape($address['tax_id']) . "', address_1 = '" . $this->db->escape($address['address_1']) . "', address_2 = '" . $this->db->escape($address['address_2']) . "', city = '" . $this->db->escape($address['city']) . "', postcode = '" . $this->db->escape($address['postcode']) . "', country_id = '" . (int)$address['country_id'] . "', zone_id = '" . (int)$address['zone_id'] . "'");
			]]></search>
			<add><![CDATA[
				
					// Adiciona juntos o campo numero e complemento
					$this->db->query("INSERT INTO " . DB_PREFIX . "address SET customer_id = '" . (int)$customer_id . "', firstname = '" . $this->db->escape($address['firstname']) . "', lastname = '" . $this->db->escape($address['lastname']) . "', company = '" . $this->db->escape($address['company']) . "', company_id = '" . $this->db->escape($address['company_id']) . "', tax_id = '" . $this->db->escape($address['tax_id']) . "', address_1 = '" . $this->db->escape($address['address_1']) . "', numero = '" . $this->db->escape($address['numero']) . "', complemento = '" . $this->db->escape($address['complemento']) . "', address_2 = '" . $this->db->escape($address['address_2']) . "', city = '" . $this->db->escape($address['city']) . "', postcode = '" . $this->db->escape($address['postcode']) . "', country_id = '" . (int)$address['country_id'] . "', zone_id = '" . (int)$address['zone_id'] . "'");
					
			]]></add>
		</operation>
		
		<operation> <!-- linha 22 geral dentro da função editCustomer() adiciona juntos cpf, cnpj, razao_social, inscricao_estadual, ddd, data_nascimento -->
			<search position="replace"><![CDATA[
			$this->db->query("UPDATE " . DB_PREFIX . "customer SET firstname = '" . $this->db->escape($data['firstname']) . "', lastname = '" . $this->db->escape($data['lastname']) . "', email = '" . $this->db->escape($data['email']) . "', telephone = '" . $this->db->escape($data['telephone']) . "', fax = '" . $this->db->escape($data['fax']) . "', newsletter = '" . (int)$data['newsletter'] . "', customer_group_id = '" . (int)$data['customer_group_id'] . "', status = '" . (int)$data['status'] . "' WHERE customer_id = '" . (int)$customer_id . "'");		
			]]></search>
			<add><![CDATA[

				if ($data['data_nascimento'] == ""){
					$dataparts[0] = "00";
					$dataparts[1] = "00";
					$dataparts[2] = "0000";
				}else{
					$dataparts = explode("/",$data['data_nascimento']);
				}
				// adiciona juntos cpf, cnpj, razao_social, inscricao_estadual, ddd, data_nascimento	
				$this->db->query("UPDATE " . DB_PREFIX . "customer SET firstname = '" . $this->db->escape($data['firstname']) . "', lastname = '" . $this->db->escape($data['lastname']) . "', email = '" . $this->db->escape($data['email']) . "', telephone = '" . $this->db->escape($data['telephone']) . "',cpf = '" . $this->db->escape($data['cpf']) . "',cnpj = '" . $this->db->escape($data['cnpj']) . "',razao_social = '" . $this->db->escape($data['razao_social']) . "',inscricao_estadual = '" . $this->db->escape($data['inscricao_estadual']) . "',ddd = '" . $this->db->escape($data['ddd']) . "', data_nascimento = '" . $this->db->escape($dataparts[2]."-".$dataparts[1]."-".$dataparts[0]) . "',ddd2 = '" . $this->db->escape($data['ddd2']) . "', telephone2 = '" . $this->db->escape($data['telephone2']) . "',  sexo = '" . $this->db->escape($data['sexo']) . "', placa1 = '',placa2 = '', fax = '" . $this->db->escape($data['fax']) . "', newsletter = '" . (int)$data['newsletter'] . "', customer_group_id = '" . (int)$data['customer_group_id'] . "', status = '" . (int)$data['status'] . "' WHERE customer_id = '" . (int)$customer_id . "'");
				 	
			]]></add>
		</operation>
		
		<operation> <!-- linha 32 geral dentro da função  editCustomer() adiciona os campos numero e complemento na tabela de endereço -->
			<search position="replace" ><![CDATA[		
			$this->db->query("INSERT INTO " . DB_PREFIX . "address SET address_id = '" . (int)$address['address_id'] . "', customer_id = '" . (int)$customer_id . "', firstname = '" . $this->db->escape($address['firstname']) . "', lastname = '" . $this->db->escape($address['lastname']) . "', company = '" . $this->db->escape($address['company']) . "', company_id = '" . $this->db->escape($address['company_id']) . "', tax_id = '" . $this->db->escape($address['tax_id']) . "', address_1 = '" . $this->db->escape($address['address_1']) . "', address_2 = '" . $this->db->escape($address['address_2']) . "', city = '" . $this->db->escape($address['city']) . "', postcode = '" . $this->db->escape($address['postcode']) . "', country_id = '" . (int)$address['country_id'] . "', zone_id = '" . (int)$address['zone_id'] . "'");
			]]></search>
			<add><![CDATA[
				
					// Adiciona juntos o campo numero e complemento
					$this->db->query("INSERT INTO " . DB_PREFIX . "address SET address_id = '" . (int)$address['address_id'] . "', customer_id = '" . (int)$customer_id . "', firstname = '" . $this->db->escape($address['firstname']) . "', lastname = '" . $this->db->escape($address['lastname']) . "', company = '" . $this->db->escape($address['company']) . "', company_id = '" . $this->db->escape($address['company_id']) . "', tax_id = '" . $this->db->escape($address['tax_id']) . "', address_1 = '" . $this->db->escape($address['address_1']) . "', numero = '" . $this->db->escape($address['numero']) . "', complemento = '" . $this->db->escape($address['complemento']) . "', address_2 = '" . $this->db->escape($address['address_2']) . "', city = '" . $this->db->escape($address['city']) . "', postcode = '" . $this->db->escape($address['postcode']) . "', country_id = '" . (int)$address['country_id'] . "', zone_id = '" . (int)$address['zone_id'] . "'");
				
			]]></add>
		</operation>
		<operation> <!-- linha 227 geral dentro da função getAddress() adiciona os campos numero e complemento no retorno da função getAddess()-->
			<search position="after" ><![CDATA[ 
			'address_1'      => $address_query->row['address_1'],
			]]></search>
			<add><![CDATA[
			'numero'      =>  ($address_query->row['numero'] <> "") ? $address_query->row['numero'] : "" ,
			'complemento'      => ($address_query->row['complemento'] <> "") ? $address_query->row['complemento'] : "" , 
			]]></add>
		</operation>	
	</file>	
	<file name="admin/controller/sale/customer.php">
		<operation>	<!-- linha 3 - funções de validação cpf e cnpj -->
			<search position="after" ><![CDATA[
			private $error = array();
			]]></search>
			<add><![CDATA[
			// Inicio validação de CPF e CNPJ fonte do código http://feloliveira.com.br/blog/validar-cpf-e-cnpj-em-php/
				private function replace($string){
					return $string = str_replace("/","", str_replace("-","",str_replace(".","",$string)));
				}
				private function check_fake($string, $length){
					for($i = 0; $i <= 9; $i++) {
						$fake = str_pad("", $length, $i);
						if($string === $fake)
							return(1);
					}
				}
				public function cpf($tax_id) {
					
					$cpf = preg_replace( "@[./-]@", "", $tax_id );
					for( $i = 0; $i < 10; $i++ ){ 
					if ( $cpf ==  str_repeat( $i , 11) or !preg_match("@^[0-9]{11}$@", $cpf ) or $cpf == "12345678909" )                    return false;                
									if ( $i < 9 ) $soma[]  = $cpf{$i} * ( 10 - $i ); 
							$soma2[] = $cpf{$i} * ( 11 - $i );                       
					} 
					
					if(((array_sum($soma)% 11) < 2 ? 0 : 11 - ( array_sum($soma)  % 11 )) != $cpf{9})return false; 
							return ((( array_sum($soma2)% 11 ) < 2 ? 0 : 11 - ( array_sum($soma2) % 11 )) != $cpf{10}) ? false : true; 
				}

				public function cnpj($company_id) {
					$cnpj = preg_replace( "@[./-]@", "", $company_id );
					if( strlen( $cnpj ) <> 14 or !is_numeric( $cnpj ) ){
							return false;
					}
			 
					$k = 6;
					$soma1 = "";
					$soma2 = "";
			 
					for( $i = 0; $i < 13; $i++ ){
							$k = $k == 1 ? 9 : $k;
							$soma2 += ( $cnpj{$i} * $k );
							$k--;
							
							if($i < 12) {
									if($k == 1) {
											$k = 9;
											$soma1 += ( $cnpj{$i} * $k );
											$k = 1;
									} else {
											$soma1 += ( $cnpj{$i} * $k );
									}
							}
					}

					$digito1 = $soma1 % 11 < 2 ? 0 : 11 - $soma1 % 11;
					$digito2 = $soma2 % 11 < 2 ? 0 : 11 - $soma2 % 11;

					return ( $cnpj{12} == $digito1 and $cnpj{13} == $digito2 );
				}
				// Fim validação de CPF e CNPJ fonte do código http://feloliveira.com.br/blog/validar-cpf-e-cnpj-em-php/
				
				public function renavam($renavam) {
					if ((strlen($renavam)=="9")||(strlen($renavam)=="11")||(strlen($renavam)=="0")){
						//echo "valido";			
					}else{
						return false;	
					} 
					$soma = 0; 
					$renavam_array = str_split($renavam);
					for ($i = 0; $i < 10; $i++) {
						
						if ((strlen($renavam)=="9") &&($i+2 < 10)){
							$soma += (int)$renavam_array[$i]*($i+2);
						}elseif (strlen($renavam)=="11"){
							$soma += (int)$renavam_array[$i]*($i+2);
						}
					}
					//echo $soma."<br>";
					$soma = $soma % 11;

					$ultimoDigito = ($soma == 10)? 0: $soma;
					$digitoInformado = substr($renavam, -1);
					//echo $digitoInformado."<br>";
					//echo $ultimoDigito."<br>";
					if($ultimoDigito == $digitoInformado){
						return true;
					}
					return false;
				}
			
			]]></add>
		</operation>		
				
		
		<operation> <!-- linha 673 geral dentro da função getForm() coloca validação nos campos novos -->
			<search position="after" offset="1"><![CDATA[
			$this->data['error_lastname'] = '';
			]]></search>
			<add><![CDATA[
			
				if (isset($this->error['data_nascimento'])) {
					$this->data['error_data_nascimento'] = $this->error['data_nascimento'];
				} else {
					$this->data['error_data_nascimento'] = '';
				}
						
				if (isset($this->error['cpf'])) {
					$this->data['error_cpf'] = $this->error['cpf'];
				} else {
					$this->data['error_cpf'] = '';
				}
						
				if (isset($this->error['cnpj'])) {
					$this->data['error_cnpj'] = $this->error['cnpj'];
				} else {
					$this->data['error_cnpj'] = '';
				}
				
				if (isset($this->error['address_numero'])) {
					$this->data['error_address_numero'] = $this->error['address_numero'];
				} else {
					$this->data['error_address_numero'] = '';
				}
				
				if (isset($this->error['ddd'])) {
					$this->data['error_ddd'] = $this->error['ddd'];
				} else {
					$this->data['error_ddd'] = '';
				}	

				/*
				if (isset($this->error['ddd2'])) {
					$this->data['error_ddd2'] = $this->error['ddd2'];
				} else {
					$this->data['error_ddd2'] = '';
				}
				
				if (isset($this->error['telephone2'])) {
					$this->data['error_telephone2'] = $this->error['telephone2'];
				} else {
					$this->data['error_telephone2'] = '';
				}
				*/
				/*
				if (isset($this->error['placa1'])) {
					$this->data['error_placa1'] = $this->error['placa1'];
				} else {
					$this->data['error_placa1'] = '';
				}
				
				if (isset($this->error['placa2'])) {
					$this->data['error_placa2'] = $this->error['placa2'];
				} else {
					$this->data['error_placa2'] = '';
				}
				*/
				
				if (isset($this->error['sexo'])) {
					$this->data['error_sexo'] = $this->error['sexo'];
				} else {
					$this->data['error_sexo'] = '';
				}
				
				if (isset($this->error['razao_social'])) {
					$this->data['error_razao_social'] = $this->error['razao_social'];
				} else {
					$this->data['error_razao_social'] = '';
				}
			
			]]></add>
		</operation>
		<operation>	<!-- linha 706 geral dentro da função getForm() retira a validação do lastname -->
			<search position="replace" offset="4" ><![CDATA[
			if (isset($this->error['address_lastname'])) {
			]]></search>
			<add><![CDATA[
			
			]]></add>
		</operation>
		<operation> <!-- linha 841 geral dentro da função validateForm() cria as variaveis dos campos novos para ser usado no arquivo de template -->
			<search position="after" offset="1"><![CDATA[
			$this->data['telephone'] = '';
			]]></search>
			<add><![CDATA[
		
			   if (isset($this->request->post['data_nascimento'])) {
					$this->data['data_nascimento'] = $this->request->post['data_nascimento'];
				} elseif (isset($customer_info)) {
					$this->data['data_nascimento'] = $customer_info['data_nascimento'];
				} else {
					$this->data['data_nascimento'] = '';
				}
						
				if (isset($this->request->post['cpf'])) {
					$this->data['cpf'] = $this->request->post['cpf'];
				} elseif (isset($customer_info)) {
					$this->data['cpf'] = $customer_info['cpf'];
				} else {
					$this->data['cpf'] = '';
				}
						
				if (isset($this->request->post['cnpj'])) {
					$this->data['cnpj'] = $this->request->post['cnpj'];
				} elseif (isset($customer_info)) {
					$this->data['cnpj'] = $customer_info['cnpj'];
				} else {
					$this->data['cnpj'] = '';
				}
						
				if (isset($this->request->post['razao_social'])) {
					$this->data['razao_social'] = $this->request->post['razao_social'];
				} elseif (isset($customer_info)) {
					$this->data['razao_social'] = $customer_info['razao_social'];
				} else {
					$this->data['razao_social'] = '';
				}
						
				if (isset($this->request->post['inscricao_estadual'])) {
					$this->data['inscricao_estadual'] = $this->request->post['inscricao_estadual'];
				} elseif (isset($customer_info)) {
					$this->data['inscricao_estadual'] = $customer_info['inscricao_estadual'];
				} else {
					$this->data['inscricao_estadual'] = '';
				}
				
				if (isset($this->request->post['ddd'])) {
					$this->data['ddd'] = $this->request->post['ddd'];
				} elseif (isset($customer_info)) {
					$this->data['ddd'] = $customer_info['ddd'];
				} else {
					$this->data['ddd'] = '';
				}	
				
				if (isset($this->request->post['ddd2'])) {
					$this->data['ddd2'] = $this->request->post['ddd2'];
				} elseif (isset($customer_info)) {
					$this->data['ddd2'] = $customer_info['ddd2'];
				} else {
					$this->data['ddd2'] = '';
				}
				
				if (isset($this->request->post['telephone2'])) {
					$this->data['telephone2'] = $this->request->post['telephone2'];
				} elseif (isset($customer_info)) {
					$this->data['telephone2'] = $customer_info['telephone2'];
				} else {
					$this->data['telephone2'] = '';
				}
				/*
				if (isset($this->request->post['placa1'])) {
					$this->data['placa1'] = $this->request->post['placa1'];
				} elseif (isset($customer_info)) {
					$this->data['placa1'] = $customer_info['placa1'];
				} else {
					$this->data['placa1'] = '';
				}
				
				if (isset($this->request->post['placa2'])) {
					$this->data['placa2'] = $this->request->post['placa2'];
				} elseif (isset($customer_info)) {
					$this->data['placa2'] = $customer_info['placa2'];
				} else {
					$this->data['placa2'] = '';
				}
				*/
				if (isset($this->request->post['sexo'])) {
					$this->data['sexo'] = $this->request->post['sexo'];
				} elseif (isset($customer_info)) {
					$this->data['sexo'] = $customer_info['sexo'];
				} else {
					$this->data['sexo'] = '';
				}
				
			
			]]></add>
		</operation>
			
		<operation> <!-- linha 953 geral dentro da função validateForm() adiciona validação para os campos novos -->
			<search position="after" offset="1"><![CDATA[
			$this->error['email'] = $this->language->get('error_email');
			]]></search>
			<add><![CDATA[
			
			 // separa a data
                if (strlen(utf8_decode($this->request->post['data_nascimento'])) < 1) {
					$this->error['data_nascimento'] = "O campo Data de Nascimento é obrigatório";  			
				}
                if ($this->request->post['pessoa'] == "fisica"){
                
						if ((strlen(utf8_decode($this->request->post['cpf'])) < 1) || (strlen(utf8_decode($this->request->post['cpf'])) > 14)) {
								$this->error['cpf'] = "O CPF é obrigatório";  
						}elseif (!$this->cpf($this->request->post['cpf'])){
							$this->error['cpf'] = "O CPF é inválido!";  
						}
					
                }else if ($this->request->post['pessoa'] == "juridica"){
             
						 if ((strlen(utf8_decode($this->request->post['cnpj'])) < 1) || (strlen(utf8_decode($this->request->post['cnpj'])) > 18)&&($this->request->post['pessoa'] == "juridica")) {
						$this->error['cnpj'] = "O CNPJ é obrigatório";
						}elseif (!$this->cnpj($this->request->post['cnpj'])){
							$this->error['cnpj'] = "O CNPJ é inválido!";  
						}
						
						if ((strlen(utf8_decode($this->request->post['razao_social'])) < 1)) {
							$this->error['razao_social'] = "O campo Razão Social é obrigatório";
						}
						
                }
				
				if ((strlen(utf8_decode($this->request->post['ddd'])) < 1)) {
                        $this->error['ddd'] = "O campo ddd é obrigatório";
				}
				
				if ((strlen(utf8_decode($this->request->post['ddd'])) < 1)) {
                        $this->error['ddd'] = "O campo ddd é obrigatório";
				}
				/*
				if ((strlen(utf8_decode($this->request->post['placa1'])) < 1)) {
                        $this->error['placa1'] = "O campo Renavam é obrigatório";
				}elseif (!$this->renavam($this->request->post['placa1'])){
					$this->error['placa1'] = "O Renavam é inválido!";  
				}
				*/
				if ((strlen(utf8_decode($this->request->post['sexo'])) < 1)) {
                        $this->error['sexo'] = "O campo Sexo é obrigatório";
				}
				
				
			]]></add>
		</operation>			
		<operation>	<!-- linha 983 geral dentro da função validateForm() adiciona validação obrigatória no campo numero -->
			<search position="after" offset="" ><![CDATA[
			foreach ($this->request->post['address'] as $key => $value) {
			]]></search>
			<add><![CDATA[
			
				if ((utf8_strlen($value['numero']) < 1) ) {
					$this->error['address_numero'][$key] = "O campo numero é obrigatório!";
				}
			
			]]></add>
		</operation>
		
		
		<operation>	<!-- linha 1304 adiciona DDD em autocompletar na parte de inclusão de pedido pelo administrativo -->
			<search position="after" ><![CDATA[
			'fax'               => $result['fax'],
			]]></search>
			<add><![CDATA[
			'ddd'               => $result['ddd'],
			]]></add>
		</operation>
		
	</file>	 
	<file name="admin/view/template/sale/customer_form.tpl">
		<operation> <!-- linha 1 geral - adiciona javascript de mascara e funções de cpf e CNPJ -->
			<search position="after" ><![CDATA[
			<?php echo $header; ?>
			]]></search>
			<add><![CDATA[
			
				<script type="text/javascript" src="../catalog/view/javascript/jquery.maskedinput-1.3.min.js"></script>
				<script>
				 $(document).ready(function() {
				 
				  $("input[name='data_nascimento'] ").mask("99/99/9999");
				  $("input[name='ddd'] ").mask("(99)");
				  //$("input[name='telephone'] ").mask("9999-9999");
				  $("input[name='ddd2'] ").mask("(99)");
				  $("input[name='postcode'] ").mask("99999-999");
				 // $("input[name='placa1'] ").mask("aaa-9999");
				 // $("input[name='placa2'] ").mask("aaa-9999");
				  $("#cpf").mask("999.999.999-99");
				  $("#cnpj").mask("99.999.999/9999-99");
				  
				/* formulário de criação de conta */
					if ($("#fisica").is(':checked')) {
						$('.pessoa_fisica').show();
						$('.pessoa_juridica').hide();
						// $("#placa2").hide();						
					}
					if ($("#juridica").is(':checked')) {
						$('.pessoa_fisica').hide();
						$('.pessoa_juridica').show(); 
						// $("#placa2").show();						
					}
					$('#juridica').click( function() {
						$("#cpf").val("");
						$('.pessoa_fisica').hide();
						$('.pessoa_juridica').show();  
						// $("#placa2").show();						
					});
					$('#fisica').click( function() {
						$("#cnpj").val("");
						$('.pessoa_fisica').show();
						$('.pessoa_juridica').hide();
						// $("#placa2").hide();
					}); 
				});
			</script>
		
			]]></add>
		</operation>
		
		<operation> <!-- linha 56 geral - adiciona ddd separado ao campo telefone -->
			<search position="replace" ><![CDATA[
			<td><input type="text" name="telephone" value="<?php echo $telephone; ?>" />
			]]></search>
			<add><![CDATA[
			
				<td><input type="text" name="ddd" size="2" style="width:30px;" value="<?php echo $ddd; ?>" /> 
				 <?php if ($error_ddd) { ?>
                  <span class="error"><?php echo $error_ddd; ?></span>
                  <?php  } ?>		
				<input type="text" name="telephone" style="width:90px;" maxlength="9" value="<?php echo $telephone; ?>" />								
			
			]]></add>
		</operation>
		<operation>  <!-- linha 58 geral - adiciona campos cpf e CNPJ ... -->
			<search position="after" offset="2"><![CDATA[
			<span class="error"><?php echo $error_telephone; ?></span>
			]]></search>
			<add><![CDATA[
			<tr>
			  <td>Celular</td>
			  <td>
				<input type="text" name="ddd2" size="2" maxlength="2" style="width:30px;min-width:30px;" value="<?php echo $ddd2; ?>" /> 
				<input type="text" name="telephone2" value="<?php echo $telephone2; ?>" maxlength="9" style="width:90px;"/>
				</td>
			</tr>
			
			<tr>
			  <td><span class="required">*</span> Sexo:</td>
			  <td>
				<?php $sexo; if ($sexo=="m") {?>
					<input type="radio" name="sexo" value="m"  id="masculino" checked /> <label for="masculino">Masculino</label> <input type="radio" name="sexo" value="f"  id="feminino"/> <label for="feminino">Feminino </label>
				<?php }elseif ($sexo=="f"){ ?>
					<input type="radio" name="sexo" value="m"  id="masculino"/> <label for="masculino">Masculino</label> <input type="radio" name="sexo" value="f"  id="feminino" checked /> <label for="feminino">Feminino </label>
				<?php }else{ ?>	
					<input type="radio" name="sexo" value="m"  id="masculino"/> <label for="masculino">Masculino</label> <input type="radio" name="sexo" value="f"  id="feminino"/> <label for="feminino">Feminino </label>
				<?php } ?>
				<?php if ($error_sexo) { ?>
				<span class="error"><?php echo $error_sexo; ?></span>
				<?php } ?></td>
			</tr>
			
			 <tr>
			  <td><span class="required">*</span> Data de Nascimento:</td>
			  <?php 
			  $dataparts = explode("-",$data_nascimento);
			  if (sizeof($dataparts)<>"3"){
				  $data = $data_nascimento;
			  }else{
				  $data = $dataparts[2]."/".$dataparts[1]."/".$dataparts[0]; 
			  }
			  ?>
			  <td><input type="text" name="data_nascimento" value="<?php echo $data; ?>"> 
			  <?php if ($error_data_nascimento) { ?>
			  <span class="error"><?php echo $error_data_nascimento; ?></span>
			  <?php } ?>
			  </td>
			</tr>
			<tr>
			  <td>Tipo:</td>
			  <td >
				  <?php if ($cpf<>"" ){?>
				  <input type="radio" name="pessoa" id="fisica" checked value="fisica">
				  Pessoa Física 
				  <input type="radio" id="juridica" name="pessoa" value="juridica">
				  Pessoa Juridica
				  <?php }else if ($cnpj<>"" ){?>
				  <input type="radio" name="pessoa" id="fisica" value="fisica">
				  Pessoa Física 
				  <input type="radio" id="juridica" name="pessoa" checked value="juridica">
				  Pessoa Juridica
				  <?php
				  }else{
				  ?>
				  <input type="radio" name="pessoa" id="fisica" checked value="fisica">
				  Pessoa Física 
				  <input type="radio" id="juridica" name="pessoa" value="juridica">
				  Pessoa Juridica
				  <?php
				  }
				  ?> 
			  </td>
			</tr>
			<tr class="pessoa_fisica">
			  <td><span class="required">*</span> CPF:</td>
			  <td><input type="text" name="cpf"  id="cpf" value="<?php echo $cpf; ?>" > 
			  <?php if ($error_cpf) { ?>
			  <span class="error"><?php echo $error_cpf; ?></span>
			  <?php } ?></td>
			</tr>
			<tr class="pessoa_juridica">
			  <td><span class="required">*</span> CNPJ:</td>
			  <td><input type="text" name="cnpj" id="cnpj" value="<?php echo $cnpj; ?>">
			   <?php if ($error_cnpj) { ?>
			  <span class="error"><?php echo $error_cnpj; ?></span>
			  <?php } ?>
			  </td>
			</tr>
			<tr class="pessoa_juridica">
			  <td><span class="required">*</span> Razão Social:</td>
			  <td><input type="text" name="razao_social" value="<?php echo $razao_social; ?>"> 
			   <?php if ($error_razao_social) { ?>
			  <span class="error"><?php echo $error_razao_social; ?></span>
			  <?php } ?>
			  </td>
			</tr>
			<tr class="pessoa_juridica">
			  <td>Inscrição Estadual:</td>
			  <td><input type="text" name="inscricao_estadual" value="<?php echo $inscricao_estadual; ?>"> </td>
			</tr>	
			<?php
			/*
			<tr>
			  <td><span class="required">*</span> Renavam</td>
			  <td><input type="text" name="placa1" maxlength="11" value="<?php echo $placa1; ?>" />
				<?php if ($error_placa1) { ?>
				<span class="error"><?php echo $error_placa1; ?></span>
				<?php } ?></td>
			</tr>	
		    <tr id="placa2">
			  <td>Renavam 2</td>
			  <td><input type="text" name="placa2" maxlength="11" value="<?php echo $placa2; ?>" />
				</td>
			</tr>	
			*/ ?>
			]]></add>
		</operation>
		
		
		
		<operation> <!-- linha 160 geral - adiciona numero e complemento na parte geral-->
			<search position="before" offset="1" index="1"><![CDATA[
			<td><?php echo $entry_address_2; ?></td>
			]]></search>
			<add><![CDATA[
		
				<tr>
					<td><span class="required">*</span> Número: </td>
					<td><input type="text" name="address[<?php echo $address_row; ?>][numero]" value="<?php echo $address['numero']; ?>" />
					<?php if (isset($error_address_numero[$address_row])) { ?>
					<span class="error"><?php echo $error_address_numero[$address_row]; ?></span>
					<?php } ?>
					</td>
                </tr>
				<tr>
					<td>Complemento: </td>
					<td><input type="text" name="address[<?php echo $address_row; ?>][complemento]" value="<?php echo $address['complemento']; ?>" /></td>
                </tr>				
		
			]]></add>
		</operation>
		
		
		
		<operation> <!-- linha 385 geral - adiciona numero e complemento na parte de endereço -->
			<search position="before" offset="1" ><![CDATA[
			html += '      <td><?php echo $entry_address_2; ?></td>';
			]]></search>
			<add><![CDATA[
		
				html += '    <tr>';
				html += '<td><span class="required">*</span> Número: </td>';
				html += '      <td><input type="text" name="address[' + address_row + '][numero]" value="" /></td>';
				html += '    </tr>';
				html += '    <tr>';
				html += '<td>Complemento: </td>';
				html += '      <td><input type="text" name="address[' + address_row + '][complemento]" value="" /></td>';
				html += '    </tr>';			
		
			]]></add>
		</operation>	 
	</file>
	
	
	<!-- INICIO, DAQUI PARA BAIXO É SÓ PARA VERSÕES 1.5.4.1 ####################################################### -->
	<!-- ################################################################################################## -->
	<!-- ################################################################################################## -->
	<file name="admin/view/template/sale/order_form.tpl">
		<operation> <!-- linha 1 geral - adiciona javascript de mascara e funções de cpf e CNPJ -->
			<search position="after" ><![CDATA[
			<?php echo $header; ?>
			]]></search>
			<add><![CDATA[
			
				<script type="text/javascript" src="../catalog/view/javascript/jquery.maskedinput-1.3.min.js"></script>
				<script>
				 $(document).ready(function() {
				 
				  $("input[name='data_nascimento'] ").mask("99/99/9999");
				  $("input[name='ddd'] ").mask("(99)");
				 // $("input[name='telephone'] ").mask("9999-9999");
				  $("input[name='fax'] ").mask("(99) 9999-9999");
				  $("input[name='postcode'] ").mask("99999-999");
				  $("#cpf").mask("999.999.999-99");
				  $("#cnpj").mask("99.999.999/9999-99");
				/* formulário de criação de conta */
					if ($("#fisica").is(':checked')) {
						$('.pessoa_fisica').show();
						$('.pessoa_juridica').hide();    
					}
					if ($("#juridica").is(':checked')) {
						$('.pessoa_fisica').hide();
						$('.pessoa_juridica').show(); 
					}
					$('#juridica').click( function() {
						$("#cpf").val("");
					$('.pessoa_fisica').hide();
						$('.pessoa_juridica').show();    
				});
					$('#fisica').click( function() {
						$("#cnpj").val("");
					$('.pessoa_fisica').show();
						$('.pessoa_juridica').hide();
				}); 
				});    
			</script>
		
			]]></add>
		</operation>
	
		<operation> <!-- linha 75 geral - adiciona ddd separado ao campo telefone -->
			<search position="replace" ><![CDATA[
			<td><input type="text" name="telephone" value="<?php echo $telephone; ?>" />
			]]></search>
			<add><![CDATA[
			
				<td><input type="text" name="ddd" size="2" value="<?php echo $ddd; ?>" /> 
				 <?php if ($error_ddd) { ?>
                  <span class="error"><?php echo $error_ddd; ?></span>
                  <?php  } ?>		
				<input type="text" name="telephone" value="<?php echo $telephone; ?>" />								
			
			]]></add>
		</operation>
		<operation>  <!-- linha 77 geral - adiciona campos cpf e CNPJ ... -->
			<search position="after" offset="2"><![CDATA[
			<span class="error"><?php echo $error_telephone; ?></span>
			]]></search>
			<add><![CDATA[
			<?php 
			/* 
			if ($this->config->get('dados_status')){ ?>
			 <tr>
			  <td><?php if ($this->config->get('dados_nascimento')){?><span class="required">*</span><?php } ?> Data de Nascimento:</td>
			  <?php 
			  $dataparts = explode("-",$data_nascimento);
			  if (sizeof($dataparts)<>"3"){
				  $data = $data_nascimento;
			  }else{
				  $data = $dataparts[2]."/".$dataparts[1]."/".$dataparts[0]; 
			  }
			  ?>
			  <td><input type="text" name="data_nascimento" value="<?php echo $data; ?>"> 
			  <?php if ($error_data_nascimento) { ?>
			  <span class="error"><?php echo $error_data_nascimento; ?></span>
			  <?php } ?>
			  </td>
			</tr>
			<tr>
			  <td>Tipo:</td>
			  <td >
				  <?php if ($cpf<>"" ){?>
				  <input type="radio" name="pessoa" id="fisica" checked value="fisica">
				  Pessoa Física 
				  <input type="radio" id="juridica" name="pessoa" value="juridica">
				  Pessoa Juridica
				  <?php }else if ($cnpj<>"" ){?>
				  <input type="radio" name="pessoa" id="fisica" value="fisica">
				  Pessoa Física 
				  <input type="radio" id="juridica" name="pessoa" checked value="juridica">
				  Pessoa Juridica
				  <?php
				  }else{
				  ?>
				  <input type="radio" name="pessoa" id="fisica" checked value="fisica">
				  Pessoa Física 
				  <input type="radio" id="juridica" name="pessoa" value="juridica">
				  Pessoa Juridica
				  <?php
				  } 
				  ?> 
			  </td>
			</tr>
			<tr class="pessoa_fisica">
			  <td><?php if ($this->config->get('dados_cpf')){?><span class="required">*</span><?php } ?> CPF:</td>
			  <td><input type="text" name="cpf"  id="cpf" value="<?php echo $cpf; ?>" > 
			  <?php if ($error_cpf) { ?>
			  <span class="error"><?php echo $error_cpf; ?></span>
			  <?php } ?></td>
			</tr>
			<tr class="pessoa_juridica">
			  <td><?php if ($this->config->get('dados_cnpj')){?><span class="required">*</span><?php } ?> CNPJ:</td>
			  <td><input type="text" name="cnpj" id="cnpj" value="<?php echo $cnpj; ?>">
			   <?php if ($error_cnpj) { ?>
			  <span class="error"><?php echo $error_cnpj; ?></span>
			  <?php } ?>
			  </td>
			</tr>
			<tr class="pessoa_juridica">
			  <td>Razão Social:</td>
			  <td><input type="text" name="razao_social" value="<?php echo $razao_social; ?>"> </td>
			</tr>
			<tr class="pessoa_juridica">
			  <td>Inscrição Estadual:</td>
			  <td><input type="text" name="inscricao_estadual" value="<?php echo $inscricao_estadual; ?>"> </td>
			</tr>	
			<?php } 
			*/
			?>
			]]></add>
		</operation>
		<operation> <!-- linha 81 geral - apaga todos os sobrenomes -->
			<search position="replace" offset="1"><![CDATA[
			<td><?php echo $entry_fax; ?></td>
			]]></search>
			<add><![CDATA[
			<td colspan="2" style="border: none;"></td>
			]]></add>
		</operation>
			
		<operation> <!-- linha 112, 203 geral - apaga todos os campos empresa -->
			<search position="replace" offset="3" ><![CDATA[
			<td><?php echo $entry_company; ?></td>
			]]></search>
			<add><![CDATA[
			]]></add>
		</operation>
		<operation> <!-- linha 115 geral - apaga todos os campos id empresa e id taxa --> 
			<search position="replace" offset="9" ><![CDATA[
			<td><span id="company-id-required" class="required">*</span> <?php echo $entry_company_id; ?></td>
			]]></search>
			<add><![CDATA[
			]]></add>
		</operation>
		
		<operation> <!-- linha 134, 214 geral - troca nome --> 
			<search position="replace" ><![CDATA[ 
			<td><?php echo $entry_address_2; ?></td>
			]]></search>
			<add><![CDATA[
			<td>Bairro: </td>
			]]></add>
		</operation>
		<operation> <!-- linha 135 geral - coloca campo novo de numero e complemento de entrega --> 
			<search position="before" offset="2"><![CDATA[ 
			<td><input type="text" name="payment_address_2" value="<?php echo $payment_address_2; ?>" /></td>
			]]></search>
			<add><![CDATA[
			

			<tr>
              <td><span class="required">*</span> Numero:</td>
              <td><input type="text" name="payment_numero" value="<?php echo $payment_numero; ?>" /></td>
            </tr>
			<tr>
              <td>Complemento:</td>
              <td><input type="text" name="payment_complemento" value="<?php echo $payment_complemento; ?>" /></td>
            </tr>

		
			]]></add>
		</operation>
		<operation> <!-- linha 215 geral - coloca campo novo de numero e complemento de entrega --> 
			<search position="before" offset="2"><![CDATA[ 
			<td><input type="text" name="shipping_address_2" value="<?php echo $shipping_address_2; ?>" /></td>
			]]></search>
			<add><![CDATA[
			

			<tr>
              <td><span class="required">*</span> Numero:</td>
              <td><input type="text" name="shipping_numero" value="<?php echo $shipping_numero; ?>" /></td>
            </tr>
			<tr>
              <td>Complemento:</td>
              <td><input type="text" name="shipping_complemento" value="<?php echo $shipping_complemento; ?>" /></td>
            </tr>

		
			]]></add>
		</operation>
		<operation><!-- linha 604 adiciona DDD em autocompletar na parte de inclusão de pedido pelo administrativo -->
			<search position="after" ><![CDATA[ 
			fax: item['fax'],
			]]></search>
			<add><![CDATA[
			ddd: item['ddd'],
			]]></add>
		</operation>
		<operation><!-- linha 618 adiciona DDD em autocompletar na parte de inclusão de pedido pelo administrativo -->
			<search position="after" ><![CDATA[ 
			$('input[name=\'fax\']').attr('value', ui.item['fax']);
			]]></search>
			<add><![CDATA[
			$('input[name=\'ddd\']').attr('value', ui.item['ddd']);
			]]></add>
		</operation>
		
		<operation><!-- linha 769 adiciona numero e complemento em autocompletar na parte de inclusão de pedido pelo administrativo -->
			<search position="after" ><![CDATA[ 
				$('input[name=\'payment_city\']').attr('value', json['city']);
			]]></search>
			<add><![CDATA[
				$('input[name=\'payment_numero\']').attr('value', json['numero']);
				$('input[name=\'payment_complemento\']').attr('value', json['complemento']);
			]]></add>
		</operation>
		<operation><!-- linha 836 adiciona numero e complemento em autocompletar na parte de inclusão de pedido pelo administrativo -->
			<search position="after" ><![CDATA[ 
				$('input[name=\'shipping_city\']').attr('value', json['city']);
			]]></search>
			<add><![CDATA[
				$('input[name=\'shipping_numero\']').attr('value', json['numero']);
				$('input[name=\'shipping_complemento\']').attr('value', json['complemento']);
			]]></add>
		</operation>
		
		
	</file>
	
	<file name="catalog/controller/checkout/manual.php">
		<operation><!-- linha 328 - apaga as variaveis que poderia vir para não dar erro ao tentar inserir produto pelo administrativo  -->
			<search position="replace" offset="1"><![CDATA[ 
				'lastname'       => $this->request->post['shipping_lastname'],
			]]></search>
			<add><![CDATA[
				'lastname'       => " ",
				'company'        => " ",
			]]></add>
		</operation>
		<operation><!-- linha 507 - apaga as variaveis que poderia vir para não dar erro ao tentar inserir produto pelo administrativo  -->
			<search position="replace" offset="1"><![CDATA[ 
				'lastname'       => $this->request->post['payment_lastname'],
			]]></search>
			<add><![CDATA[
				'lastname'       => " ",
				'company'        => " ",
			]]></add>
		</operation>		
	</file>
</modification>